[
  {
    "objectID": "simulation-and-computation.html",
    "href": "simulation-and-computation.html",
    "title": "Simulation and Computation",
    "section": "",
    "text": "Let’s get started!\n\n\n\n\nListing 1: Loading Packages and R Setup\n\n\n\nCode\nlibrary(tidyverse)\nlibrary(scidesignR)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(countrycode)\nlibrary(skimr)\n\nset.seed(4240)"
  },
  {
    "objectID": "simulation-and-computation.html#setup-stuff",
    "href": "simulation-and-computation.html#setup-stuff",
    "title": "Simulation and Computation",
    "section": "",
    "text": "Let’s get started!\n\n\n\n\nListing 1: Loading Packages and R Setup\n\n\n\nCode\nlibrary(tidyverse)\nlibrary(scidesignR)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(countrycode)\nlibrary(skimr)\n\nset.seed(4240)"
  },
  {
    "objectID": "simulation-and-computation.html#a01-ex-2-3",
    "href": "simulation-and-computation.html#a01-ex-2-3",
    "title": "Simulation and Computation",
    "section": "Exercise 2.3",
    "text": "Exercise 2.3\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nIn Section 2.3, 20 patients for Example 2.5 were randomly selected from a population of 25,000.\n\n\n\n(a) Simple Random Sample Probability\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nExplain why the probability of choosing a random sample of 20 from 25,000 is \\[\n\\frac{1} {25000 \\choose 20}\n\\]\n\n\nLet’s start with smaller population size, 6, {A, B, C, D, E, F}. And, let’s start with a smaller sample size, 1. We can pick one of {A}, {B}, {C}, {D}, {E}, or {F}. That is, there are 6 ways to have a sample of size 1. The probability of choosing a random sample of size 1 from a population of size 6 is 1/6.\nLet’s expand to a sample size 2. We know that once an individual is added to our sample, they can’t be picked again, and it doesn’t matter what order the individuals are added to the sample. Then, these are all the possible ways that we could pick them: {A, B} {A, C} {A, D} {A, E} {A, F}\n{B, C} {B, D} {B, E} {B, F}\n{C, D} {C, E} {C, F}\n{D, E} {D, F}\n{E, F}\nThat is, there are 15 ways to pick a sample of size 2. The probability of choosing a random sample of size 2 from a population of size 6 is 1/15.\nWe can recognize that the number of ways to pick a sample of size r from a population of size n is the binomial coefficient \\(\\frac{n!}{(r!(n-r)!)}\\) (i.e., “n choose r”).\n\n□\n\n\n\n(b) Simple Random Sample Probability with R\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nUse R to randomly select 4 patients from a total of 8 patients, and calculate the probability of choosing this random sample.\n\n\nExplored with R\n\n\n\n\nListing 2: Random Sample Probability\n\n\n\nCode\n# Input Parameters\npopulationSize &lt;- 8\nsampleSize &lt;- 4\n\n# Population Table\npatients &lt;- tibble(id = 1:populationSize)\n# Pick a sample\nchosenRandomSample &lt;- patients |&gt;\n    sample_n(sampleSize)\n\n# How many random samples are possible?\nnumberOfRandomSamples &lt;- choose(populationSize, sampleSize)\n\n# Probability of choosing this particular random sample\nprobabilityOfChosenRandomSample &lt;- (1 / numberOfRandomSamples)\n\n# Results\nprobabilityOfChosenRandomSampleRounded &lt;- round(probabilityOfChosenRandomSample, 3)\nprobabilityOfChosenRandomSampleRounded\n\n\n\n\n\nVisualized with R\n\n\nCode\npatients |&gt; \n    mutate(\n        \"Selected for Sample\" = if_else(id %in% chosenRandomSample$id, \"TRUE\", \"FALSE\")\n    ) |&gt; \n    kbl() |&gt; \n    kable_styling()\n\n\n\n\nTable 1: Randonly Generated Sample\n\n\n\n\n\n\nid\nSelected for Sample\n\n\n\n\n1\nFALSE\n\n\n2\nFALSE\n\n\n3\nTRUE\n\n\n4\nFALSE\n\n\n5\nTRUE\n\n\n6\nTRUE\n\n\n7\nTRUE\n\n\n8\nFALSE\n\n\n\n\n\n\n\n\nTherefore, the probability of choosing this random sample is \\(\\frac{1}{70} \\approx 0.014\\).\n\n■"
  },
  {
    "objectID": "simulation-and-computation.html#a01-ex-2-4",
    "href": "simulation-and-computation.html#a01-ex-2-4",
    "title": "Simulation and Computation",
    "section": "Exercise 2.4",
    "text": "Exercise 2.4\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nThe treatment assignment displayed in Table 2.5 is from one treatment assignment out of \\({20 \\choose 10}\\) possible random treatment assignments.\n\n\n\n(a) All Possible Treatment Assignments\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nR can be used to generate all possible combinations of 10 patients assigned to the treatment group using combn(covid_sample$id, 10). Use the command to generate the combinations and confirm that there are \\({20 \\choose 10}\\) ways to generate the treatment assignments.\n\n\n\n\nCode\n# Variables\ncovid_patientPopulationSize = 25000\ncovid_treatmentSampleSize &lt;- 20\ncovid_activeTreatmentSampleSize &lt;- 10 # the number of patients to be assigned to the active treatment (i.e., no placebo)\n\n#################################\n# The population of Covid Patients\ncovid_patientPopulation &lt;- tibble(id = 1:covid_patientPopulationSize)\n\n# The sample of covid patients that we will treat\ncovid_treatmentSamplePatients &lt;- covid_patientPopulation |&gt; \n    sample_n(covid_treatmentSampleSize)\n\n# Of the sample of patients we will treat, every possible combination of those that will receive the active treatment\nallPossibleActiveTreatmentSamplePatients &lt;- covid_treatmentSamplePatients$id |&gt; \n    combn(covid_activeTreatmentSampleSize) |&gt; \n    as_tibble()\n\n\nWarning: The `x` argument of `as_tibble.matrix()` must have unique column names if\n`.name_repair` is omitted as of tibble 2.0.0.\nℹ Using compatibility `.name_repair`.\n\n\nCode\nexpectedActiveTreatmentSampleCombinationsSize &lt;- choose(covid_treatmentSampleSize, covid_activeTreatmentSampleSize)\n\n\n###########################\ncovid_treatmentSamplePatients |&gt; \n    kbl(caption=\"COVID Patients to Receive Treatment Sample\") |&gt; \n    kable_styling()\n\n\n\nCOVID Patients to Receive Treatment Sample\n\n\nid\n\n\n\n\n16715\n\n\n17290\n\n\n20264\n\n\n14181\n\n\n10921\n\n\n4883\n\n\n16803\n\n\n19022\n\n\n16250\n\n\n18137\n\n\n1475\n\n\n9472\n\n\n15340\n\n\n8489\n\n\n13396\n\n\n20749\n\n\n17983\n\n\n14717\n\n\n15458\n\n\n18309\n\n\n\n\n\nCode\nncol(allPossibleActiveTreatmentSamplePatients)\n\n\n[1] 184756\n\n\nCode\nexpectedActiveTreatmentSampleCombinationsSize\n\n\n[1] 184756\n\n\n\n□\n\n\n\n(b) Treatment Counts Under Complete Randomization\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nTo generate the random array of treatment assignments in Table 2.5, R was used to randomly select 10 patients for the active treatment first and then assigned the placebo to the remaining 10. We can also generate a random treatment assignment vector by randomly selecting a column from the matrix of all possible treatment assignments created in part a. In R, randomly select a column and assign the first 10 to the active treatment and the rest to the placebo. Repeat a few times and discuss whether the procedure results in random assignments as desired. (Hint: You can use if_else(condition, true, false) inside mutate to return true when condition is met and false otherwise.)\n\n\n\n\nCode\n# Pick a random number between 1 and the total number of combinations to choose the patients that will get the active treatment\nrandomColumnNumberFrom_allPossibleActiveTreatmentSamplePatients &lt;- sample(1:ncol(allPossibleActiveTreatmentSamplePatients),1)\n# Get all the patient IDs that will get the active treatment\ncovid_activeTreatmentSamplePatients &lt;- allPossibleActiveTreatmentSamplePatients |&gt; \n    pull(randomColumnNumberFrom_allPossibleActiveTreatmentSamplePatients)\n\n\n########################################\ndisplay &lt;- covid_treatmentSamplePatients |&gt; \n    mutate(\n        treatmentAssignment = if_else(id %in% covid_activeTreatmentSamplePatients, \"Active\", \"Placebo\")\n    ) |&gt; \n    arrange(treatmentAssignment, id)\n\nindex &lt;- auto_index(display$treatmentAssignment)\n\ndisplay |&gt; \n    kbl() |&gt; \n    pack_rows(index = index) |&gt; \n    kable_styling()\n\n\n\n\n\nid\ntreatmentAssignment\n\n\n\n\nActive\n\n\n13396\nActive\n\n\n14181\nActive\n\n\n15340\nActive\n\n\n15458\nActive\n\n\n16250\nActive\n\n\n16803\nActive\n\n\n17983\nActive\n\n\n19022\nActive\n\n\n20264\nActive\n\n\n20749\nActive\n\n\nPlacebo\n\n\n1475\nPlacebo\n\n\n4883\nPlacebo\n\n\n8489\nPlacebo\n\n\n9472\nPlacebo\n\n\n10921\nPlacebo\n\n\n14717\nPlacebo\n\n\n16715\nPlacebo\n\n\n17290\nPlacebo\n\n\n18137\nPlacebo\n\n\n18309\nPlacebo\n\n\n\n\n\nOur first step uses a simple random sample of 20 patients from our population to receive treatment. Using this sample, we generate all possible combinations of choosing 10 patients. (i.e., \\({20 \\choose 10} = 184,756\\) possible combinations) Picking a random number from 1:184756 and giving those 10 patients the active treatment is still a simple random sample. We are always guaranteed to have exactly 20 randomly selected patients from the population, and exactly 10 of those will be randomly selected to receive the active treatment. This proceudre does result in random assignments as desired.\n\n□\n\n\n\n(c) Comparison to Independent Assignment\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nAnother scheme we may consider is to assign TRT or PLA to each patient with equal probabilities independently. Implement the procedure in R. Repeat a few times and discuss whether the procedure results in random assignments as desired.\n\n\n\n\nCode\n# \"Equal Probability Assuming Independence\"\nequalProbabilty &lt;- sample(c(\"TRT\",\"PLA\"), size = covid_treatmentSampleSize, replace = TRUE)\n\n# Assign TRT or PLA to each patient independently\ncovid_treatmentSamplePatients |&gt; \n    mutate(\n        treatmentAssignment = sample(c(\"TRT\",\"PLA\"), size = covid_treatmentSampleSize, replace = TRUE)\n    ) |&gt; \n    select(treatmentAssignment) |&gt; \n    group_by(treatmentAssignment) |&gt; \n    summarize(n = n()) |&gt; \n    kbl() |&gt; \n    kable_styling()\n\n\n\n\n\ntreatmentAssignment\nn\n\n\n\n\nPLA\n9\n\n\nTRT\n11\n\n\n\n\n\nCode\n## TODO: run a loop and document the distribution ... good to plot it as well. \ndf &lt;- data.frame(id = 1:100, trialTRT = NA)\nfor (trial in 1:100) {\n    currentTrial &lt;- covid_treatmentSamplePatients |&gt; \n    mutate(\n        treatmentAssignment = sample(c(\"TRT\",\"PLA\"), size = covid_treatmentSampleSize, replace = TRUE)\n    ) |&gt; \n    select(treatmentAssignment) |&gt; \n    group_by(treatmentAssignment) |&gt; \n    summarize(n = n()) \n\n    df$trialTRT[trial] &lt;- currentTrial$n[currentTrial$treatmentAssignment==\"TRT\"]\n}\n\ndict &lt;- data.frame(\n    TRT = 0:20,\n    n = 0\n)\nfor (i in 1:100) {\n    currentValue &lt;- df[i,]$trialTRT\n    dict[dict$TRT==currentValue,]$n &lt;- dict[dict$TRT==currentValue,]$n + 1\n}\n\ndf |&gt; \n    group_by(TRT = trialTRT) |&gt; \n    select(TRT) |&gt; \n    summarise(n = n())\n\n\n# A tibble: 13 × 2\n     TRT     n\n   &lt;int&gt; &lt;int&gt;\n 1     4     1\n 2     5     1\n 3     6     3\n 4     7     8\n 5     8    11\n 6     9    20\n 7    10    13\n 8    11    16\n 9    12    11\n10    13     7\n11    14     7\n12    15     1\n13    16     1\n\n\nCode\ndict |&gt; \n    ggplot(aes(\n        x = factor(TRT),\n        y = n\n        )) +\n    geom_col() +\n    geom_vline(xintercept = 11)\n\n\n\n\n\n\n\n\n\n\n□\n\n\n\n(d) Alternatives\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nCan you think of another procedure in R for randomly assigning 10 patients to active treatment? Implement your own procedure in R to verify the procedure results in random assignments.\n\n\n\n\nCode\ncovid_treatmentSamplePatients |&gt; \n    arrange(id) |&gt; ### Obviously when this step is added, it won't be random.\n    mutate(treatmentAssignment = if_else(row_number(id) &lt;= covid_activeTreatmentSampleSize, \"TRT\", \"PLA\"))\n\n\n# A tibble: 20 × 2\n      id treatmentAssignment\n   &lt;int&gt; &lt;chr&gt;              \n 1  1475 TRT                \n 2  4883 TRT                \n 3  8489 TRT                \n 4  9472 TRT                \n 5 10921 TRT                \n 6 13396 TRT                \n 7 14181 TRT                \n 8 14717 TRT                \n 9 15340 TRT                \n10 15458 TRT                \n11 16250 PLA                \n12 16715 PLA                \n13 16803 PLA                \n14 17290 PLA                \n15 17983 PLA                \n16 18137 PLA                \n17 18309 PLA                \n18 19022 PLA                \n19 20264 PLA                \n20 20749 PLA                \n\n\nCode\nnewDict &lt;- data.frame(\n    id = 0,\n    n = 0\n)\n\nfor(i in 1:1000) {\n    this_covid_treatmentSamplePatients &lt;- covid_patientPopulation |&gt; \n        sample_n(covid_treatmentSampleSize) |&gt; \n        arrange(id) |&gt; \n        mutate(treatmentAssignment = if_else(row_number(id) &lt;= covid_activeTreatmentSampleSize, \"TRT\", \"PLA\"))\n\n\n}\n\n\n\n■"
  },
  {
    "objectID": "simulation-and-computation.html#a01-ex-2-11",
    "href": "simulation-and-computation.html#a01-ex-2-11",
    "title": "Simulation and Computation",
    "section": "Exercise 2.11",
    "text": "Exercise 2.11\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nA chemist has seven light objects to weigh on a balance pan scale. The standard deviation of each weighing is denoted by \\(\\sigma\\). In a 1935 paper, Frank Yates suggested an improved technique by weighing all seven objects together, and also weighing them in groups of three. The groups are chosen so that each object is weighed four times altogether, twice with any other object and twice without it.\nLet \\(y_1,...,y_8\\) be the readings from the scale so that the equations for determining the unknown weights, \\(\\beta_1,...,\\beta_7\\), are\n\n\\[\n\\begin{align*}\ny_1 &= \\beta_1 + \\beta_2 + \\beta_3 + \\beta_4 + \\beta_5 + \\beta_6 + \\beta_7 + \\epsilon_1 \\\\\ny_2 &= \\beta_1 + \\beta_2 + \\beta_3 + \\epsilon_2 \\\\\ny_3 &= \\beta_1 + \\beta_4 + \\beta_5 + \\epsilon_3 \\\\\ny_4 &= \\beta_1 + \\beta_6 + \\beta_7 + \\epsilon_4 \\\\\ny_5 &= \\beta_2 + \\beta_4 + \\beta_6 + \\epsilon_5 \\\\\ny_6 &= \\beta_2 + \\beta_5 + \\beta_7 + \\epsilon_6 \\\\\ny_7 &= \\beta_3 + \\beta_4 + \\beta_7 + \\epsilon_7 \\\\\ny_8 &= \\beta_3 + \\beta_5 + \\beta_6 + \\epsilon_8\n\\end{align*}\n\\]\nwhere the \\(\\epsilon_i,i=1,...,8\\) are independent errors.\nHotelling suggested modifying Yates’ procedure by placing in the other pan of the scale those of the objects not included in one of his weighings. In other words if the first three objects are to be weighed, then the remaining four objects would be placed in the opposite pan.\n\n\n\n(a) Yates’ Procedure\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nWrite Yates’ procedure in matrix form and find the least squares estimates of β.\n\n\nYates’ procedure can be written using the matrix form:\n\\[\ny = X\\beta + \\epsilon\n\\] \\[\n\\begin{pmatrix}\n    y_1 \\\\ y_2 \\\\ y_3 \\\\ y_4 \\\\ y_5 \\\\ y_6 \\\\ y_7 \\\\ y_8\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n    1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\n    1 & 1 & 1 & 0 & 0 & 0 & 0 \\\\\n    1 & 0 & 0 & 1 & 1 & 0 & 0 \\\\\n    1 & 0 & 0 & 0 & 0 & 1 & 1 \\\\\n    0 & 1 & 0 & 1 & 0 & 1 & 0 \\\\\n    0 & 1 & 0 & 0 & 1 & 0 & 1 \\\\\n    0 & 0 & 1 & 1 & 0 & 0 & 1 \\\\\n    0 & 0 & 1 & 0 & 1 & 1 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n    \\beta_1 \\\\ \\beta_2 \\\\ \\beta_3 \\\\ \\beta_4 \\\\ \\beta_5 \\\\ \\beta_6 \\\\ \\beta_7\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n    \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\epsilon_3 \\\\ \\epsilon_4 \\\\\n    \\epsilon_5 \\\\ \\epsilon_6 \\\\ \\epsilon_7 \\\\ \\epsilon_8\n\\end{pmatrix}\n\\]\n\n\n\nCode\nYates &lt;- matrix(\n    c(\n    1, 1, 1, 1, 1, 1, 1,\n    1, 1, 1, 0, 0, 0, 0,\n    1, 0, 0, 1, 1, 0, 0,\n    1, 0, 0, 0, 0, 1, 1,\n    0, 1, 0, 1, 0, 1, 0,\n    0, 1, 0, 0, 1, 0, 1,\n    0, 0, 1, 1, 0, 0, 1,\n    0, 0, 1, 0, 1, 1, 0\n  ),\n  nrow = 8,\n  ncol = 7,\n  byrow = TRUE\n)\n\n# X\nX &lt;- Yates\nX\n\n\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7]\n[1,]    1    1    1    1    1    1    1\n[2,]    1    1    1    0    0    0    0\n[3,]    1    0    0    1    1    0    0\n[4,]    1    0    0    0    0    1    1\n[5,]    0    1    0    1    0    1    0\n[6,]    0    1    0    0    1    0    1\n[7,]    0    0    1    1    0    0    1\n[8,]    0    0    1    0    1    1    0\n\n\nCode\n# X'X\nY &lt;- t(X) %*% X\nY\n\n\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7]\n[1,]    4    2    2    2    2    2    2\n[2,]    2    4    2    2    2    2    2\n[3,]    2    2    4    2    2    2    2\n[4,]    2    2    2    4    2    2    2\n[5,]    2    2    2    2    4    2    2\n[6,]    2    2    2    2    2    4    2\n[7,]    2    2    2    2    2    2    4\n\n\nCode\n# (X'X)^-1\nW &lt;- solve(Y)\nW\n\n\n        [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]\n[1,]  0.4375 -0.0625 -0.0625 -0.0625 -0.0625 -0.0625 -0.0625\n[2,] -0.0625  0.4375 -0.0625 -0.0625 -0.0625 -0.0625 -0.0625\n[3,] -0.0625 -0.0625  0.4375 -0.0625 -0.0625 -0.0625 -0.0625\n[4,] -0.0625 -0.0625 -0.0625  0.4375 -0.0625 -0.0625 -0.0625\n[5,] -0.0625 -0.0625 -0.0625 -0.0625  0.4375 -0.0625 -0.0625\n[6,] -0.0625 -0.0625 -0.0625 -0.0625 -0.0625  0.4375 -0.0625\n[7,] -0.0625 -0.0625 -0.0625 -0.0625 -0.0625 -0.0625  0.4375\n\n\nCode\n# (X'X)^-1 * X'\nA &lt;- W %*% t(X)\nA\n\n\n       [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]    [,8]\n[1,] 0.0625  0.3125  0.3125  0.3125 -0.1875 -0.1875 -0.1875 -0.1875\n[2,] 0.0625  0.3125 -0.1875 -0.1875  0.3125  0.3125 -0.1875 -0.1875\n[3,] 0.0625  0.3125 -0.1875 -0.1875 -0.1875 -0.1875  0.3125  0.3125\n[4,] 0.0625 -0.1875  0.3125 -0.1875  0.3125 -0.1875  0.3125 -0.1875\n[5,] 0.0625 -0.1875  0.3125 -0.1875 -0.1875  0.3125 -0.1875  0.3125\n[6,] 0.0625 -0.1875 -0.1875  0.3125  0.3125 -0.1875 -0.1875  0.3125\n[7,] 0.0625 -0.1875 -0.1875  0.3125 -0.1875  0.3125  0.3125 -0.1875\n\n\nLet \\(X\\) be the design matrix, where each row \\(i\\) corresponds to an individual instance of weighing, and where each column \\(j\\) represents a “light object”.\n\\[\nX = \\begin{pmatrix}\n    1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\n    1 & 1 & 1 & 0 & 0 & 0 & 0 \\\\\n    1 & 0 & 0 & 1 & 1 & 0 & 0 \\\\\n    1 & 0 & 0 & 0 & 0 & 1 & 1 \\\\\n    0 & 1 & 0 & 1 & 0 & 1 & 0 \\\\\n    0 & 1 & 0 & 0 & 1 & 0 & 1 \\\\\n    0 & 0 & 1 & 1 & 0 & 0 & 1 \\\\\n    0 & 0 & 1 & 0 & 1 & 1 & 0\n\\end{pmatrix}\n\\]\nThen each entry in the design matrix is defined as\n\\[\nx_{ij} = \\begin{cases}\n    1 &\\text{object } j \\text{ is on the scale in weighing } i \\\\\n    0 &\\text{object } j \\text{ is not included in weighing } i\n\\end{cases}\n\\]\nThen, it follows that a column of \\(X\\) is the participation pattern of one object across all weighings. For example Object 1 is in Weighing 1, 2, 3, and 4.\nAnd so the normal matrix is:\n\\[\nX^{T}X = \\begin{pmatrix}\n    4 & 2 & 2 & 2 & 2 & 2 & 2 \\\\\n    2 & 4 & 2 & 2 & 2 & 2 & 2 \\\\\n    2 & 2 & 4 & 2 & 2 & 2 & 2 \\\\\n    2 & 2 & 2 & 4 & 2 & 2 & 2 \\\\\n    2 & 2 & 2 & 2 & 4 & 2 & 2 \\\\\n    2 & 2 & 2 & 2 & 2 & 4 & 2 \\\\\n    2 & 2 & 2 & 2 & 2 & 2 & 4\n\\end{pmatrix}\n\\]\nWhich clearly results in each row \\(j\\) and each column \\(k\\) both representing an object, and the \\((j,k)\\) entry is the number of weighings that include both objects as defined by:\n\\[\n(X^{T}X)_{jk} = \\sum_{i=1}^{8}x_{ij}x_{ik}\n\\]\nIt is clear to see that when \\(j = k\\) the object has been in 4 weighings - this is true for every object. It is also clear to see that when \\(j \\not = k\\) that the objects are in exactly 2 weighings with each other - this is also true for every pair of objects.\nTherefore, our interpretations are that:\n\nthe diagonal represents how well each object is measured individually, and\nthe off-diagonal represents how entangled pairs of objects are\n\nWe continue with the inverse normal matrix, which helps us better understand the unvertainty of the design.\n\\[\n(X^\\top X)^{-1}\n=\n\\frac{1}{16}\n\\begin{pmatrix}\n7 & -1 & -1 & -1 & -1 & -1 & -1 \\\\\n-1 &  7 & -1 & -1 & -1 & -1 & -1 \\\\\n-1 & -1 &  7 & -1 & -1 & -1 & -1 \\\\\n-1 & -1 & -1 &  7 & -1 & -1 & -1 \\\\\n-1 & -1 & -1 & -1 &  7 & -1 & -1 \\\\\n-1 & -1 & -1 & -1 & -1 &  7 & -1 \\\\\n-1 & -1 & -1 & -1 & -1 & -1 &  7\n\\end{pmatrix}\n\\]\nAs expected, we see symmetry and our interpretations are:\n\nthe diagonal represents the noise of each individual objects; the higher the value the harder to estimate (i.e., relative variance)\n\n“How much estimation uncertainty object j gets per unit of measurement noise”\n\nthe off-diagonal represents the entanglement between objects and how uncertainty is shared\n\n\\[\n\\text{Cov}(\\hat{\\beta}_j,\\hat{\\beta}_k) = -\\frac{\\sigma^2}{16}\n\\]\nWe then proceed to the least-squares operator\n\\[\n(X^\\top X)^{-1}X^\\top\n=\n\\frac{1}{16}\n\\begin{pmatrix}\n1 & 5 & 5 & 5 & -3 & -3 & -3 & -3 \\\\\n1 & 5 & -3 & -3 & 5 & 5 & -3 & -3 \\\\\n1 & 5 & -3 & -3 & -3 & -3 & 5 & 5 \\\\\n1 & -3 & 5 & -3 & 5 & -3 & 5 & -3 \\\\\n1 & -3 & 5 & -3 & -3 & 5 & -3 & 5 \\\\\n1 & -3 & -3 & 5 & 5 & -3 & -3 & 5 \\\\\n1 & -3 & -3 & 5 & -3 & 5 & 5 & -3\n\\end{pmatrix}\n\\]\nWhich, when multiplied by \\(\\underset{n \\times 1}{y}\\) gives us our least squares estimators:\n\n\\[\n\\hat{\\beta}_1\n= \\frac{1}{16}\n\\bigl(\ny_1\n+ 5y_2\n+ 5y_3\n+ 5y_4\n- 3y_5\n- 3y_6\n- 3y_7\n- 3y_8\n\\bigr)\n\\] \\[\n\\hat{\\beta}_2\n= \\frac{1}{16}\n\\bigl(\ny_1\n+ 5y_2\n- 3y_3\n- 3y_4\n+ 5y_5\n+ 5y_6\n- 3y_7\n- 3y_8\n\\bigr)\n\\]\n\\[\n\\hat{\\beta}_3\n= \\frac{1}{16}\n\\bigl(\ny_1\n+ 5y_2\n- 3y_3\n- 3y_4\n- 3y_5\n- 3y_6\n+ 5y_7\n+ 5y_8\n\\bigr)\n\\]\n\\[\n\\hat{\\beta}_4\n= \\frac{1}{16}\n\\bigl(\ny_1\n- 3y_2\n+ 5y_3\n- 3y_4\n+ 5y_5\n- 3y_6\n+ 5y_7\n- 3y_8\n\\bigr)\n\\]\n\\[\n\\hat{\\beta}_5\n= \\frac{1}{16}\n\\bigl(\ny_1\n- 3y_2\n+ 5y_3\n- 3y_4\n- 3y_5\n+ 5y_6\n- 3y_7\n+ 5y_8\n\\bigr)\n\\]\n\\[\n\\hat{\\beta}_6\n= \\frac{1}{16}\n\\bigl(\ny_1\n- 3y_2\n- 3y_3\n+ 5y_4\n+ 5y_5\n- 3y_6\n- 3y_7\n+ 5y_8\n\\bigr)\n\\]\n\\[\n\\hat{\\beta}_7\n= \\frac{1}{16}\n\\bigl(\ny_1\n- 3y_2\n- 3y_3\n+ 5y_4\n- 3y_5\n+ 5y_6\n+ 5y_7\n- 3y_8\n\\bigr)\n\\]\n\n□\n\n\n\n(b) Hotelling’s Procuedure\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nWrite Hotelling’s procedure in matrix form\n\n\nHotelling’s procedure can be written using the matrix form:\n\\[\ny = X\\beta + \\epsilon\n\\] \\[\n\\begin{pmatrix}\n    y_1 \\\\ y_2 \\\\ y_3 \\\\ y_4 \\\\ y_5 \\\\ y_6 \\\\ y_7 \\\\ y_8\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n    1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\n    1 & 1 & 1 & -1 & -1 & -1 & -1 \\\\\n    1 & -1 & -1 & 1 & 1 & -1 & -1 \\\\\n    1 & -1 & -1 & -1 & -1 & 1 & 1 \\\\\n    -1 & 1 & -1 & 1 & -1 & 1 & -1 \\\\\n    -1 & 1 & -1 & -1 & 1 & -1 & 1 \\\\\n    -1 & -1 & 1 & 1 & -1 & -1 & 1 \\\\\n    -1 & -1 & 1 & -1 & 1 & 1 & -1\n\\end{pmatrix}\n\\begin{pmatrix}\n    \\beta_1 \\\\ \\beta_2 \\\\ \\beta_3 \\\\ \\beta_4 \\\\ \\beta_5 \\\\ \\beta_6 \\\\ \\beta_7\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n    \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\epsilon_3 \\\\ \\epsilon_4 \\\\\n    \\epsilon_5 \\\\ \\epsilon_6 \\\\ \\epsilon_7 \\\\ \\epsilon_8\n\\end{pmatrix}\n\\]\nLet \\(Z\\) be the design matrix for Hotteling’s procedure, where each row \\(i\\) corresponds to an individual instance of weighing, and where each column \\(j\\) represents a “light object”.\n\\[\nZ = \\begin{pmatrix}\n    1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\n    1 & 1 & 1 & -1 & -1 & -1 & -1 \\\\\n    1 & -1 & -1 & 1 & 1 & -1 & -1 \\\\\n    1 & -1 & -1 & -1 & -1 & 1 & 1 \\\\\n    -1 & 1 & -1 & 1 & -1 & 1 & -1 \\\\\n    -1 & 1 & -1 & -1 & 1 & -1 & 1 \\\\\n    -1 & -1 & 1 & 1 & -1 & -1 & 1 \\\\\n    -1 & -1 & 1 & -1 & 1 & 1 & -1\n\\end{pmatrix}\n\\]\nThen each entry in the design matrix is defined as\n\\[\nz_{ij} = \\begin{cases}\n    1 &\\text{object } j \\text{ is on the left pan of the scale in weighing } i \\\\\n    -1 &\\text{object } j \\text{ is on the right pan of the scale in weighing } i \\\\\n\\end{cases}\n\\]\n\n□\n\n\n\n(c) Variance Comparison\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nFind the variance of a weight using Yates’ and Hotelling’s procedures.\n\n\nAs we already have \\[\ny = X\\beta + \\epsilon, \\qquad \\mathbb{E}[\\epsilon]=0, \\qquad \\text{Var}(\\epsilon)=\\sigma^2I,\n\\]\nand we’ve already computed the least squares estimator\n\\[\n\\hat{\\beta} = (X^{T}X)^{-1}X^{T}y\n\\]\nand we’ve already computed the variance-covariance matrix\n\\[\n\\text{Var}(\\hat{\\beta})=\\sigma^2(X^{T}X)^{-1}\n\\]\nThus the diagonal entries of the variance covariance matrix are the variances \\(\\text{Var}(\\hat{\\beta_j})\\)\nFor Yates, we’ve already done this\n\\[\n\\text{Var}(\\hat{\\beta_j}) = \\sigma^2\\frac{7}{16} \\quad \\text{for all } j = 1,...,7\n\\]\nFor Hotelling we will follow the same steps as we did previously (i.e., design matrix –&gt; normal matrix –&gt; inverse normal matrix)\n\n\nCode\nHotelling &lt;- matrix(\n    c(\n    1, 1, 1, 1, 1, 1, 1,\n    1, 1, 1, -1, -1, -1, -1,\n    1, -1, -1, 1, 1, -1, -1,\n    1, -1, -1, -1, -1, 1, 1,\n    -1, 1, -1, 1, -1, 1, -1,\n    -1, 1, -1, -1, 1, -1, 1,\n    -1, -1, 1, 1, -1, -1, 1,\n    -1, -1, 1, -1, 1, 1, -1\n  ),\n  nrow = 8,\n  ncol = 7,\n  byrow = TRUE\n)\n\n# Z (i.e., Design Matrix)\nZ &lt;- Hotelling\nZ\n\n\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7]\n[1,]    1    1    1    1    1    1    1\n[2,]    1    1    1   -1   -1   -1   -1\n[3,]    1   -1   -1    1    1   -1   -1\n[4,]    1   -1   -1   -1   -1    1    1\n[5,]   -1    1   -1    1   -1    1   -1\n[6,]   -1    1   -1   -1    1   -1    1\n[7,]   -1   -1    1    1   -1   -1    1\n[8,]   -1   -1    1   -1    1    1   -1\n\n\nCode\n# Z'Z (i.e., ZY; Normal Matrix)\nZY &lt;- t(Z) %*% Z\nZY\n\n\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7]\n[1,]    8    0    0    0    0    0    0\n[2,]    0    8    0    0    0    0    0\n[3,]    0    0    8    0    0    0    0\n[4,]    0    0    0    8    0    0    0\n[5,]    0    0    0    0    8    0    0\n[6,]    0    0    0    0    0    8    0\n[7,]    0    0    0    0    0    0    8\n\n\nCode\n# (Z'Z)^-1 (i.e., ZW; Inverse Normal Matrix)\nZW &lt;- solve(ZY)\nZW\n\n\n      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]\n[1,] 0.125 0.000 0.000 0.000 0.000 0.000 0.000\n[2,] 0.000 0.125 0.000 0.000 0.000 0.000 0.000\n[3,] 0.000 0.000 0.125 0.000 0.000 0.000 0.000\n[4,] 0.000 0.000 0.000 0.125 0.000 0.000 0.000\n[5,] 0.000 0.000 0.000 0.000 0.125 0.000 0.000\n[6,] 0.000 0.000 0.000 0.000 0.000 0.125 0.000\n[7,] 0.000 0.000 0.000 0.000 0.000 0.000 0.125\n\n\nCode\n# (Z'Z)^-1 * Z' (i.e., ZA; Least-Squares Operator)\nZA &lt;- ZW %*% t(Z)\nZA\n\n\n      [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]   [,8]\n[1,] 0.125  0.125  0.125  0.125 -0.125 -0.125 -0.125 -0.125\n[2,] 0.125  0.125 -0.125 -0.125  0.125  0.125 -0.125 -0.125\n[3,] 0.125  0.125 -0.125 -0.125 -0.125 -0.125  0.125  0.125\n[4,] 0.125 -0.125  0.125 -0.125  0.125 -0.125  0.125 -0.125\n[5,] 0.125 -0.125  0.125 -0.125 -0.125  0.125 -0.125  0.125\n[6,] 0.125 -0.125 -0.125  0.125  0.125 -0.125 -0.125  0.125\n[7,] 0.125 -0.125 -0.125  0.125 -0.125  0.125  0.125 -0.125\n\n\n\\[\n\\begin{align}\n    Z &= \\begin{pmatrix}\n        1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\n        1 & 1 & 1 & -1 & -1 & -1 & -1 \\\\\n        1 & -1 & -1 & 1 & 1 & -1 & -1 \\\\\n        1 & -1 & -1 & -1 & -1 & 1 & 1 \\\\\n        -1 & 1 & -1 & 1 & -1 & 1 & -1 \\\\\n        -1 & 1 & -1 & -1 & 1 & -1 & 1 \\\\\n        -1 & -1 & 1 & 1 & -1 & -1 & 1 \\\\\n        -1 & -1 & 1 & -1 & 1 & 1 & -1\n    \\end{pmatrix}\n\\\\\n    Z^{T}Z &= \\begin{pmatrix}\n        8 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n        0 & 8 & 0 & 0 & 0 & 0 & 0 \\\\\n        0 & 0 & 8 & 0 & 0 & 0 & 0 \\\\\n        0 & 0 & 0 & 8 & 0 & 0 & 0 \\\\\n        0 & 0 & 0 & 0 & 8 & 0 & 0 \\\\\n        0 & 0 & 0 & 0 & 0 & 8 & 0 \\\\\n        0 & 0 & 0 & 0 & 0 & 0 & 8\n    \\end{pmatrix}\n\\\\\n    (Z^\\top Z)^{-1}\n    &=\n    \\frac{1}{8}\n    \\begin{pmatrix}\n        1 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n        0 & 1 & 0 & 0 & 0 & 0 & 0 \\\\\n        0 & 0 & 1 & 0 & 0 & 0 & 0 \\\\\n        0 & 0 & 0 & 1 & 0 & 0 & 0 \\\\\n        0 & 0 & 0 & 0 & 1 & 0 & 0 \\\\\n        0 & 0 & 0 & 0 & 0 & 1 & 0 \\\\\n        0 & 0 & 0 & 0 & 0 & 0 & 1\n    \\end{pmatrix}\n\\end{align}\n\\]\nTherefore\n\\[\n\\text{Var}(\\hat{\\beta_j})=\\frac{\\sigma^2}{8} \\quad \\text{for all } j = 1,...,7\n\\]\n\n□\n\n\n\n(d) Recommendation\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nIf the chemist wanted estimates of the weights with the highest precision, then which procedure (Yates or Hotelling) would you recommend that the chemist use to weigh objects? Explain your reasoning.\n\n\nTo keep the estimates of the objects as precise as possible, we want the procedure with the lowest variance, which would be Hotelling’s.\n\n■"
  },
  {
    "objectID": "simulation-and-computation.html#a01-ex-2-12",
    "href": "simulation-and-computation.html#a01-ex-2-12",
    "title": "Simulation and Computation",
    "section": "Exercise 2.12",
    "text": "Exercise 2.12\n\n\n\n\n\n\nNoteExercise Instructions\n\n\n\nDoes life satisfaction change by region over time? Use the lifesat_childmort data from Example 2.15 to explore this question.\n\n\n\n\nCode\naudit_raw &lt;- lifesat_childmort |&gt;\n  summarise(\n    n_rows = n(),\n    n_lifesat = sum(!is.na(LifeSatisfaction)),\n    pct_lifesat_missing = mean(is.na(LifeSatisfaction)) * 100\n  )\n\naudit_raw\n\n\n# A tibble: 1 × 3\n  n_rows n_lifesat pct_lifesat_missing\n   &lt;int&gt;     &lt;int&gt;               &lt;dbl&gt;\n1  22595      1704                92.5\n\n\n\n\nCode\ncleanData_lifesat_childmort &lt;- lifesat_childmort |&gt;\n  filter(!is.na(LifeSatisfaction))\n\ncleanData2_lifesat_childmort &lt;- cleanData_lifesat_childmort |&gt;\n  mutate(\n    Continent2 = suppressWarnings(\n      countrycode(`Country Code`, origin = \"iso3c\", destination = \"continent\")\n    ),\n    Continent2 = factor(Continent2),\n    Year_f = factor(Year)\n  ) |&gt;\n  filter(!is.na(Continent2)) |&gt;\n  select(Continent2, Year, Year_f, LifeSatisfaction)\n\naudit_clean &lt;- cleanData2_lifesat_childmort |&gt;\n  summarise(\n    n_rows = n(),\n    n_years = n_distinct(Year),\n    n_continents = n_distinct(Continent2)\n  )\n\naudit_clean\n\n\n# A tibble: 1 × 3\n  n_rows n_years n_continents\n   &lt;int&gt;   &lt;int&gt;        &lt;int&gt;\n1   1686      14            5\n\n\n\n\nCode\ncleanData2_lifesat_childmort |&gt;\n  ggplot(aes(LifeSatisfaction)) +\n  geom_density() +\n  geom_vline(xintercept = mean(cleanData2_lifesat_childmort$LifeSatisfaction), linetype = \"dashed\") +\n  labs(title = \"Distribution of Life Satisfaction\", x = \"Life Satisfaction\", y = \"Density\")\n\n\n\n\n\n\n\n\nFigure 1: Distribution of Life Satisfaction\n\n\n\n\n\n\n\nCode\ncleanData2_lifesat_childmort |&gt;\n  ggplot(aes(x = Year, y = LifeSatisfaction, colour = Continent2)) +\n  geom_jitter(width = 0.2, alpha = 0.35) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(\n    title = \"Life Satisfaction Over Time by Continent\",\n    x = \"Year\",\n    y = \"Life Satisfaction\",\n    colour = \"Continent\"\n  )\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\nFigure 2: Life Satisfaction Over Time by Continent\n\n\n\n\n\n\n\nCode\nm1 &lt;- lm(LifeSatisfaction ~ Year + Continent2, data = cleanData2_lifesat_childmort)\nm2 &lt;- lm(LifeSatisfaction ~ Year * Continent2, data = cleanData2_lifesat_childmort)\n\nsummary(m1)\n\n\n\nCall:\nlm(formula = LifeSatisfaction ~ Year + Continent2, data = cleanData2_lifesat_childmort)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.79295 -0.58791 -0.03457  0.59240  2.16846 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)        -8.356093  11.214322  -0.745    0.456    \nYear                0.006307   0.005572   1.132    0.258    \nContinent2Americas  1.785698   0.064768  27.571   &lt;2e-16 ***\nContinent2Asia      0.936668   0.055520  16.871   &lt;2e-16 ***\nContinent2Europe    1.782287   0.057309  31.100   &lt;2e-16 ***\nContinent2Oceania   2.975140   0.176759  16.832   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.8421 on 1680 degrees of freedom\nMultiple R-squared:  0.4425,    Adjusted R-squared:  0.4409 \nF-statistic: 266.7 on 5 and 1680 DF,  p-value: &lt; 2.2e-16\n\n\n\n\nCode\n# Compare whether continent-specific time trends improve fit\nanova(m1, m2)\n\n\nAnalysis of Variance Table\n\nModel 1: LifeSatisfaction ~ Year + Continent2\nModel 2: LifeSatisfaction ~ Year * Continent2\n  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)\n1   1680 1191.4                           \n2   1676 1190.6  4   0.75125 0.2644 0.9009\n\n\n\n\n\nCall:\nlm(formula = LifeSatisfaction ~ Year * Continent2, data = cleanData2_lifesat_childmort)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.78402 -0.59173 -0.03319  0.60420  2.16141 \n\nCoefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)\n(Intercept)             -10.453258  22.821658  -0.458    0.647\nYear                      0.007349   0.011339   0.648    0.517\nContinent2Americas        8.295588  35.084814   0.236    0.813\nContinent2Asia           15.314280  30.687631   0.499    0.618\nContinent2Europe        -12.568199  31.532121  -0.399    0.690\nContinent2Oceania        32.253549  92.500633   0.349    0.727\nYear:Continent2Americas  -0.003235   0.017436  -0.186    0.853\nYear:Continent2Asia      -0.007145   0.015249  -0.469    0.639\nYear:Continent2Europe     0.007131   0.015668   0.455    0.649\nYear:Continent2Oceania   -0.014550   0.045969  -0.317    0.752\n\nResidual standard error: 0.8428 on 1676 degrees of freedom\nMultiple R-squared:  0.4429,    Adjusted R-squared:  0.4399 \nF-statistic:   148 on 9 and 1676 DF,  p-value: &lt; 2.2e-16\n\n\nInterpretation\nIn a multiple linear regression allowing continent-specific time trends, none of the interaction terms between Year and Continent were statistically significant. This suggests that while average levels of life satisfaction differ substantially across continents, the rate of change over time is broadly similar across regions. Overall, life satisfaction appears relatively stable over the observed period.\n\n■"
  },
  {
    "objectID": "simulation-and-computation.html#appendix-references",
    "href": "simulation-and-computation.html#appendix-references",
    "title": "Simulation and Computation",
    "section": "Appendix: References",
    "text": "Appendix: References\nThe following is best to ignore. It’s code I ran and didn’t end up using in the final project, but haven’t removed into somewhere else … yet.\n\n\nCode\nskim(lifesat_childmort)\n\n\n\nData summary\n\n\nName\nlifesat_childmort\n\n\nNumber of rows\n22595\n\n\nNumber of columns\n7\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\ncharacter\n3\n\n\nnumeric\n4\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: character\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmin\nmax\nempty\nn_unique\nwhitespace\n\n\n\n\nCountry\n0\n1.00\n4\n50\n0\n332\n0\n\n\nCountry Code\n1318\n0.94\n3\n8\n0\n286\n0\n\n\nContinent\n22310\n0.01\n4\n13\n0\n7\n0\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nYear\n0\n1.00\n1960.63\n51.06\n1700.00\n1946.00\n1.974e+03\n1997.00\n2.018000e+03\n▁▁▁▂▇\n\n\nTot_pop\n2514\n0.89\n20772028.22\n84002122.43\n0.00\n511000.00\n3.518e+06\n11253665.00\n1.359368e+09\n▇▁▁▁▁\n\n\nLifeSatisfaction\n20891\n0.08\n5.44\n1.12\n2.66\n4.61\n5.340e+00\n6.27\n8.020000e+00\n▁▆▇▅▃\n\n\nUnder5mort\n11389\n0.50\n75.64\n74.94\n2.10\n18.10\n4.810e+01\n110.80\n4.419000e+02\n▇▂▁▁▁\n\n\n\n\n\nCode\ncleanData_lifesat_childmort &lt;-lifesat_childmort |&gt; \n    filter(!is.na(LifeSatisfaction))\n\nskim(cleanData_lifesat_childmort)\n\n\n\nData summary\n\n\nName\ncleanData_lifesat_childmo…\n\n\nNumber of rows\n1704\n\n\nNumber of columns\n7\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\ncharacter\n3\n\n\nnumeric\n4\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: character\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmin\nmax\nempty\nn_unique\nwhitespace\n\n\n\n\nCountry\n0\n1.00\n4\n28\n0\n164\n0\n\n\nCountry Code\n0\n1.00\n3\n8\n0\n164\n0\n\n\nContinent\n1561\n0.08\n4\n13\n0\n6\n0\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nYear\n0\n1.00\n2012.33\n3.69\n2005.00\n2009.00\n2012.00\n2015.00\n2.018000e+03\n▅▆▆▇▇\n\n\nTot_pop\n736\n0.57\n52336410.75\n166399244.90\n293124.00\n5358910.00\n12442635.50\n37655194.50\n1.359368e+09\n▇▁▁▁▁\n\n\nLifeSatisfaction\n0\n1.00\n5.44\n1.12\n2.66\n4.61\n5.34\n6.27\n8.020000e+00\n▁▆▇▅▃\n\n\nUnder5mort\n178\n0.90\n33.69\n36.93\n2.10\n6.60\n17.80\n50.27\n2.109000e+02\n▇▂▁▁▁\n\n\n\n\n\nCode\ncleanData2_lifesat_childmort &lt;- cleanData_lifesat_childmort |&gt; \n    mutate(\n        Continent2 = factor(suppressWarnings(\n            countrycode(`Country Code`, origin = \"iso3c\", destination = \"continent\")\n        )),\n        Year_f = factor(Year)\n    ) |&gt; \n    filter(!is.na(Continent2)) |&gt; \n    select(Continent2, Year, Year_f, LifeSatisfaction)\nskim(cleanData2_lifesat_childmort)\n\n\n\nData summary\n\n\nName\ncleanData2_lifesat_childm…\n\n\nNumber of rows\n1686\n\n\nNumber of columns\n4\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nfactor\n2\n\n\nnumeric\n2\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: factor\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nordered\nn_unique\ntop_counts\n\n\n\n\nContinent2\n0\n1\nFALSE\n5\nAsi: 512, Eur: 445, Afr: 420, Ame: 285\n\n\nYear_f\n0\n1\nFALSE\n14\n201: 146, 201: 145, 201: 143, 201: 141\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nYear\n0\n1\n2012.32\n3.69\n2005.00\n2009.00\n2012.00\n2015.00\n2018.00\n▅▆▆▇▇\n\n\nLifeSatisfaction\n0\n1\n5.44\n1.13\n2.66\n4.61\n5.33\n6.28\n8.02\n▂▆▇▆▃\n\n\n\n\n\nCode\n# cleanData2_lifesat_childmort |&gt; \n#     ggplot(aes(Year_f, LifeSatisfaction, color = Continent2)) +\n#         geom_dotplot() \n#         #facet_grid(Continent2 ~ .)\n\ncleanData2_lifesat_childmort |&gt; \n    ggplot(aes(Year_f)) + \n        geom_bar()\n\n\n\n\n\n\n\n\n\nCode\ncleanData2_lifesat_childmort |&gt; \n    ggplot(aes(Continent2)) + \n        geom_bar()\n\n\n\n\n\n\n\n\n\nCode\n# cleanData2_lifesat_childmort |&gt; \n#     ggplot(aes(LifeSatisfaction)) + \n#         geom_dotplot(dotsize = 0.25)\n\n# cleanData2_lifesat_childmort |&gt; \n#     ggplot(aes(LifeSatisfaction)) + \n#         geom_freqpoly()\n\ncleanData2_lifesat_childmort |&gt; \n    ggplot(aes(LifeSatisfaction)) + \n        geom_density() +\n        geom_vline(xintercept = mean(cleanData2_lifesat_childmort$LifeSatisfaction))\n\n\n\n\n\n\n\n\n\nCode\nm1 &lt;- lm(LifeSatisfaction ~ Year + Continent2,\n            data = cleanData2_lifesat_childmort)\nsummary(m1)\n\n\n\nCall:\nlm(formula = LifeSatisfaction ~ Year + Continent2, data = cleanData2_lifesat_childmort)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.79295 -0.58791 -0.03457  0.59240  2.16846 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)        -8.356093  11.214322  -0.745    0.456    \nYear                0.006307   0.005572   1.132    0.258    \nContinent2Americas  1.785698   0.064768  27.571   &lt;2e-16 ***\nContinent2Asia      0.936668   0.055520  16.871   &lt;2e-16 ***\nContinent2Europe    1.782287   0.057309  31.100   &lt;2e-16 ***\nContinent2Oceania   2.975140   0.176759  16.832   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.8421 on 1680 degrees of freedom\nMultiple R-squared:  0.4425,    Adjusted R-squared:  0.4409 \nF-statistic: 266.7 on 5 and 1680 DF,  p-value: &lt; 2.2e-16\n\n\nCode\nm2 &lt;- lm(LifeSatisfaction ~ Year * Continent2,\n            data = cleanData2_lifesat_childmort)\nsummary(m2)\n\n\n\nCall:\nlm(formula = LifeSatisfaction ~ Year * Continent2, data = cleanData2_lifesat_childmort)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.78402 -0.59173 -0.03319  0.60420  2.16141 \n\nCoefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)\n(Intercept)             -10.453258  22.821658  -0.458    0.647\nYear                      0.007349   0.011339   0.648    0.517\nContinent2Americas        8.295588  35.084814   0.236    0.813\nContinent2Asia           15.314280  30.687631   0.499    0.618\nContinent2Europe        -12.568199  31.532121  -0.399    0.690\nContinent2Oceania        32.253549  92.500633   0.349    0.727\nYear:Continent2Americas  -0.003235   0.017436  -0.186    0.853\nYear:Continent2Asia      -0.007145   0.015249  -0.469    0.639\nYear:Continent2Europe     0.007131   0.015668   0.455    0.649\nYear:Continent2Oceania   -0.014550   0.045969  -0.317    0.752\n\nResidual standard error: 0.8428 on 1676 degrees of freedom\nMultiple R-squared:  0.4429,    Adjusted R-squared:  0.4399 \nF-statistic:   148 on 9 and 1676 DF,  p-value: &lt; 2.2e-16\n\n\nCode\n#levels(as.factor(cleanData2_lifesat_childmort$Continent2))\n\n\n# summarise_numeric &lt;- function(data, var) {\n#   data |&gt;\n#     summarise(\n#       Variable = var,\n#       Type = \"Numeric\",\n#       N = sum(!is.na(.data[[var]])),\n#       Missing = sum(is.na(.data[[var]])),\n#       Percent_Missing = mean(is.na(.data[[var]])) * 100,\n#       Unique = n_distinct(.data[[var]], na.rm = TRUE),\n#       Mean = mean(.data[[var]], na.rm = TRUE),\n#       Median = median(.data[[var]], na.rm = TRUE),\n#       SD = sd(.data[[var]], na.rm = TRUE),\n#       Min = min(.data[[var]], na.rm = TRUE),\n#       Max = max(.data[[var]], na.rm = TRUE)\n#     )\n# }\n\n# summarise_categorical &lt;- function(data, var) {\n#   top_level &lt;- data |&gt;\n#     filter(!is.na(.data[[var]])) |&gt;\n#     count(.data[[var]], sort = TRUE) |&gt;\n#     slice(1)\n\n#   data |&gt;\n#     summarise(\n#       Variable = var,\n#       Type = \"Categorical\",\n#       N = sum(!is.na(.data[[var]])),\n#       Missing = sum(is.na(.data[[var]])),\n#       Percent_Missing = mean(is.na(.data[[var]])) * 100,\n#       Unique = n_distinct(.data[[var]], na.rm = TRUE),\n#       Mode = top_level[[var]],\n#       Mode_Count = top_level$n\n#     )\n# }\n\n# summary_raw &lt;- bind_rows(\n#     summarise_categorical(lifesat_childmort, \"Country\"),\n#     summarise_categorical(lifesat_childmort, \"Country Code\"),\n#     summarise_categorical(lifesat_childmort, \"Continent\"),\n#     summarise_numeric(lifesat_childmort, \"Year\"),\n#     summarise_numeric(lifesat_childmort, \"Tot_pop\"),\n#     summarise_numeric(lifesat_childmort, \"LifeSatisfaction\"),\n# )\n# summary_raw\n\n# cleanData_lifesat_childmort &lt;-lifesat_childmort |&gt; \n#     mutate(\n#         is_owid = grepl(\"^OWID_\", `Country Code`),\n#         Continent2 = if_else(\n#             is_owid,\n#             NA_character_,\n#             countrycode(`Country Code`, origin = \"iso3c\", destination = \"continent\")\n#         )\n#     ) |&gt; \n#     filter(!is.na(Continent2)) |&gt; \n#     select(Continent2, Year, LifeSatisfaction) |&gt; \n#     mutate(Continent2 = factor(Continent2)) |&gt; \n#     group_by(Continent2, Year) |&gt; \n#     arrange(Continent2, Year) |&gt; \n#     summarise(\n#         'Mean Life Satisfaction' = mean(LifeSatisfaction, na.rm = T),\n#         n_lifesat = sum(!is.na(LifeSatisfaction)),\n#         .groups = \"drop\")\n\n# lifesat_childmort |&gt; \n#     mutate(\n#         is_owid = grepl(\"^OWID_\", `Country Code`),\n#         Continent2 = if_else(\n#             is_owid,\n#             NA_character_,\n#             countrycode(`Country Code`, origin = \"iso3c\", destination = \"continent\")\n#         )\n#     ) |&gt; \n#     filter(!is.na(Continent2)) |&gt; \n#     summarise(\n#         'Years Life Satisfaction' = n_distinct(Year[!is.na(LifeSatisfaction)])\n#     )\n\n# lifesat_childmort |&gt; \n#     ggplot(aes(x = Country)) +\n#         geom_bar()\n\n\n\n\n#cleanData_lifesat_childmort\n#evels(as.factor(cleanData_lifesat_childmort$Continent2))"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Design and Analysis of Experiments",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites."
  },
  {
    "objectID": "examples-and-exercises.html",
    "href": "examples-and-exercises.html",
    "title": "Design and Analysis of Experiments and Observational Studies using R – A textbook workbook",
    "section": "",
    "text": "This section documents how the project environment was created and maintained.\n\nif (!requireNamespace(\"renv\", quietly = TRUE)) {\n  install.packages(\"renv\")\n}\n\n# renv::init()\n\nrequiredPackages &lt;- c(\n  \"abind\",\n  \"agridat\",\n  \"broom\",\n  \"BsMD\",\n  \"crosstable\",\n  \"DiagrammeR\",\n  \"emmeans\",\n  \"FrF2\",\n  \"gridExtra\",\n  \"janitor\",\n  \"kableExtra\",\n  \"knitr\",\n  \"latex2exp\",\n  \"magic\",\n  \"patchwork\",\n  \"pwr\",\n  \"reticulate\",\n  \"scidesignR\",\n  \"tidyverse\"\n)\ninstall.packages(requiredPackages)\n\nThe following package(s) will be installed:\n- abind      [1.4-8]\n- agridat    [1.26]\n- broom      [1.0.12]\n- BsMD       [2023.920]\n- crosstable [0.8.2]\n- DiagrammeR [1.0.11]\n- emmeans    [2.0.1]\n- FrF2       [2.3-4]\n- gridExtra  [2.3]\n- janitor    [2.2.1]\n- kableExtra [1.4.0]\n- knitr      [1.51]\n- latex2exp  [0.9.8]\n- magic      [1.6-1]\n- patchwork  [1.3.2]\n- pwr        [1.3-0]\n- reticulate [1.45.0]\n- scidesignR [1.0.0]\n- tidyverse  [2.0.0]\nThese packages will be installed into \"C:/Users/goodb/AppData/Local/R/cache/R/renv/library/design-and-analysis-of-experiments-f16187f6/windows/R-4.5/x86_64-w64-mingw32\".\n\n# Installing packages --------------------------------------------------------\n- Installing abind 1.4-8 ...                    OK [linked from cache]\n- Installing agridat 1.26 ...                   OK [linked from cache]\n- Installing broom 1.0.12 ...                   OK [linked from cache]\n- Installing BsMD 2023.920 ...                  OK [linked from cache]\n- Installing knitr 1.51 ...                     OK [linked from cache]\n- Installing crosstable 0.8.2 ...               OK [linked from cache]\n- Installing DiagrammeR 1.0.11 ...              OK [linked from cache]\n- Installing emmeans 2.0.1 ...                  OK [linked from cache]\n- Installing FrF2 2.3-4 ...                     OK [linked from cache]\n- Installing gridExtra 2.3 ...                  OK [linked from cache]\n- Installing janitor 2.2.1 ...                  OK [linked from cache]\n- Installing kableExtra 1.4.0 ...               OK [linked from cache]\n- Installing latex2exp 0.9.8 ...                OK [linked from cache]\n- Installing magic 1.6-1 ...                    OK [linked from cache]\n- Installing patchwork 1.3.2 ...                OK [linked from cache]\n- Installing pwr 1.3-0 ...                      OK [linked from cache]\n- Installing reticulate 1.45.0 ...              OK [linked from cache]\n- Installing scidesignR 1.0.0 ...               OK [linked from cache]\n- Installing tidyverse 2.0.0 ...                OK [linked from cache]\nSuccessfully installed 19 packages in 0.17 seconds.\n\nfor (pkg in requiredPackages) {\n  suppressPackageStartupMessages(\n    library(pkg, character.only = TRUE)\n  )\n}\n\n# Helper Functions\nis_installed &lt;- function(pkg) {\n  requireNamespace(pkg, quietly = TRUE)\n}\n\nis_loaded &lt;- function(pkg) {\n  pkg %in% loadedNamespaces()\n}\n\npackage_version &lt;- function(pkg) {\n  if (is_installed(pkg)) as.character(packageVersion(pkg)) else NA_character_\n}\n\n# Build status table\npackage_status &lt;- data.frame(\n  Package = requiredPackages,\n  Version = vapply(requiredPackages, package_version, character(1)),\n  Installed = vapply(requiredPackages, is_installed, logical(1)),\n  Loaded = vapply(requiredPackages, is_loaded, logical(1))\n)\n\nkbl(package_status) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n\n\n\n\n\nPackage\nVersion\nInstalled\nLoaded\n\n\n\n\nabind\nabind\n1.4.8\nTRUE\nTRUE\n\n\nagridat\nagridat\n1.26\nTRUE\nTRUE\n\n\nbroom\nbroom\n1.0.12\nTRUE\nTRUE\n\n\nBsMD\nBsMD\n2023.920\nTRUE\nTRUE\n\n\ncrosstable\ncrosstable\n0.8.2\nTRUE\nTRUE\n\n\nDiagrammeR\nDiagrammeR\n1.0.11\nTRUE\nTRUE\n\n\nemmeans\nemmeans\n2.0.1\nTRUE\nTRUE\n\n\nFrF2\nFrF2\n2.3.4\nTRUE\nTRUE\n\n\ngridExtra\ngridExtra\n2.3\nTRUE\nTRUE\n\n\njanitor\njanitor\n2.2.1\nTRUE\nTRUE\n\n\nkableExtra\nkableExtra\n1.4.0\nTRUE\nTRUE\n\n\nknitr\nknitr\n1.51\nTRUE\nTRUE\n\n\nlatex2exp\nlatex2exp\n0.9.8\nTRUE\nTRUE\n\n\nmagic\nmagic\n1.6.1\nTRUE\nTRUE\n\n\npatchwork\npatchwork\n1.3.2\nTRUE\nTRUE\n\n\npwr\npwr\n1.3.0\nTRUE\nTRUE\n\n\nreticulate\nreticulate\n1.45.0\nTRUE\nTRUE\n\n\nscidesignR\nscidesignR\n1.0.0\nTRUE\nTRUE\n\n\ntidyverse\ntidyverse\n2.0.0\nTRUE\nTRUE\n\n\n\n\n# renv::snapshot()"
  },
  {
    "objectID": "examples-and-exercises.html#setup-section---do-not-run",
    "href": "examples-and-exercises.html#setup-section---do-not-run",
    "title": "Design and Analysis of Experiments and Observational Studies using R – A textbook workbook",
    "section": "",
    "text": "This section documents how the project environment was created and maintained.\n\nif (!requireNamespace(\"renv\", quietly = TRUE)) {\n  install.packages(\"renv\")\n}\n\n# renv::init()\n\nrequiredPackages &lt;- c(\n  \"abind\",\n  \"agridat\",\n  \"broom\",\n  \"BsMD\",\n  \"crosstable\",\n  \"DiagrammeR\",\n  \"emmeans\",\n  \"FrF2\",\n  \"gridExtra\",\n  \"janitor\",\n  \"kableExtra\",\n  \"knitr\",\n  \"latex2exp\",\n  \"magic\",\n  \"patchwork\",\n  \"pwr\",\n  \"reticulate\",\n  \"scidesignR\",\n  \"tidyverse\"\n)\ninstall.packages(requiredPackages)\n\nThe following package(s) will be installed:\n- abind      [1.4-8]\n- agridat    [1.26]\n- broom      [1.0.12]\n- BsMD       [2023.920]\n- crosstable [0.8.2]\n- DiagrammeR [1.0.11]\n- emmeans    [2.0.1]\n- FrF2       [2.3-4]\n- gridExtra  [2.3]\n- janitor    [2.2.1]\n- kableExtra [1.4.0]\n- knitr      [1.51]\n- latex2exp  [0.9.8]\n- magic      [1.6-1]\n- patchwork  [1.3.2]\n- pwr        [1.3-0]\n- reticulate [1.45.0]\n- scidesignR [1.0.0]\n- tidyverse  [2.0.0]\nThese packages will be installed into \"C:/Users/goodb/AppData/Local/R/cache/R/renv/library/design-and-analysis-of-experiments-f16187f6/windows/R-4.5/x86_64-w64-mingw32\".\n\n# Installing packages --------------------------------------------------------\n- Installing abind 1.4-8 ...                    OK [linked from cache]\n- Installing agridat 1.26 ...                   OK [linked from cache]\n- Installing broom 1.0.12 ...                   OK [linked from cache]\n- Installing BsMD 2023.920 ...                  OK [linked from cache]\n- Installing knitr 1.51 ...                     OK [linked from cache]\n- Installing crosstable 0.8.2 ...               OK [linked from cache]\n- Installing DiagrammeR 1.0.11 ...              OK [linked from cache]\n- Installing emmeans 2.0.1 ...                  OK [linked from cache]\n- Installing FrF2 2.3-4 ...                     OK [linked from cache]\n- Installing gridExtra 2.3 ...                  OK [linked from cache]\n- Installing janitor 2.2.1 ...                  OK [linked from cache]\n- Installing kableExtra 1.4.0 ...               OK [linked from cache]\n- Installing latex2exp 0.9.8 ...                OK [linked from cache]\n- Installing magic 1.6-1 ...                    OK [linked from cache]\n- Installing patchwork 1.3.2 ...                OK [linked from cache]\n- Installing pwr 1.3-0 ...                      OK [linked from cache]\n- Installing reticulate 1.45.0 ...              OK [linked from cache]\n- Installing scidesignR 1.0.0 ...               OK [linked from cache]\n- Installing tidyverse 2.0.0 ...                OK [linked from cache]\nSuccessfully installed 19 packages in 0.17 seconds.\n\nfor (pkg in requiredPackages) {\n  suppressPackageStartupMessages(\n    library(pkg, character.only = TRUE)\n  )\n}\n\n# Helper Functions\nis_installed &lt;- function(pkg) {\n  requireNamespace(pkg, quietly = TRUE)\n}\n\nis_loaded &lt;- function(pkg) {\n  pkg %in% loadedNamespaces()\n}\n\npackage_version &lt;- function(pkg) {\n  if (is_installed(pkg)) as.character(packageVersion(pkg)) else NA_character_\n}\n\n# Build status table\npackage_status &lt;- data.frame(\n  Package = requiredPackages,\n  Version = vapply(requiredPackages, package_version, character(1)),\n  Installed = vapply(requiredPackages, is_installed, logical(1)),\n  Loaded = vapply(requiredPackages, is_loaded, logical(1))\n)\n\nkbl(package_status) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n\n\n\n\n\nPackage\nVersion\nInstalled\nLoaded\n\n\n\n\nabind\nabind\n1.4.8\nTRUE\nTRUE\n\n\nagridat\nagridat\n1.26\nTRUE\nTRUE\n\n\nbroom\nbroom\n1.0.12\nTRUE\nTRUE\n\n\nBsMD\nBsMD\n2023.920\nTRUE\nTRUE\n\n\ncrosstable\ncrosstable\n0.8.2\nTRUE\nTRUE\n\n\nDiagrammeR\nDiagrammeR\n1.0.11\nTRUE\nTRUE\n\n\nemmeans\nemmeans\n2.0.1\nTRUE\nTRUE\n\n\nFrF2\nFrF2\n2.3.4\nTRUE\nTRUE\n\n\ngridExtra\ngridExtra\n2.3\nTRUE\nTRUE\n\n\njanitor\njanitor\n2.2.1\nTRUE\nTRUE\n\n\nkableExtra\nkableExtra\n1.4.0\nTRUE\nTRUE\n\n\nknitr\nknitr\n1.51\nTRUE\nTRUE\n\n\nlatex2exp\nlatex2exp\n0.9.8\nTRUE\nTRUE\n\n\nmagic\nmagic\n1.6.1\nTRUE\nTRUE\n\n\npatchwork\npatchwork\n1.3.2\nTRUE\nTRUE\n\n\npwr\npwr\n1.3.0\nTRUE\nTRUE\n\n\nreticulate\nreticulate\n1.45.0\nTRUE\nTRUE\n\n\nscidesignR\nscidesignR\n1.0.0\nTRUE\nTRUE\n\n\ntidyverse\ntidyverse\n2.0.0\nTRUE\nTRUE\n\n\n\n\n# renv::snapshot()"
  },
  {
    "objectID": "examples-and-exercises.html#jupyter-notebook-setup",
    "href": "examples-and-exercises.html#jupyter-notebook-setup",
    "title": "Design and Analysis of Experiments and Observational Studies using R – A textbook workbook",
    "section": "Jupyter Notebook Setup",
    "text": "Jupyter Notebook Setup\n\n# Reproducibility / Display Defaults\noptions(\n  stringAsFactors = FALSE,\n  repos = c(CRAN = \"http://cloud.r-project.org\"),\n  warn = 1\n)\nset.seed(123)"
  },
  {
    "objectID": "examples-and-exercises.html#welcome",
    "href": "examples-and-exercises.html#welcome",
    "title": "Design and Analysis of Experiments and Observational Studies using R – A textbook workbook",
    "section": "Welcome",
    "text": "Welcome\n\n# List of all packages used\nrequiredPackages &lt;- c(\n  \"tidyverse\",\n  \"knitr\",\n  \"kableExtra\",\n  \"reticulate\",\n  \"janitor\",\n  \"latex2exp\",\n  \"gridExtra\",\n  \"broom\",\n  \"patchwork\",\n  \"crosstable\",\n  \"agridat\",\n  \"FrF2\",\n  \"pwr\",\n  \"emmeans\",\n  \"DiagrammeR\",\n  \"abind\",\n  \"magic\",\n  \"BsMD\",\n  \"scidesignR\"\n)\n\n# Sort all the packages alphabetically\nrequiredPackages &lt;- sort(unique(requiredPackages))\n\n# Display the current status of all the packages: Package Name | Installed Status | Installed Version | Loaded Status -- first sort the packages in Alphabetical Order (A --&gt; Z)\n\n\n\n# Check if package is already installed, if it doesn't, it gets installed. \n# TODO: Create a \"report\" that has the list of all packages that are required and if they are installed before starting. Then, update it after they are installed to confirm they are installed, then output the table: Package | Version | Install Status Before | Install Status After\n\n# Loads all required packages\n# TODO: Create a report similar to the installation one, but now it would be Package | Version | Load Status Before | Load Status After"
  },
  {
    "objectID": "examples-and-exercises.html#chapter-1",
    "href": "examples-and-exercises.html#chapter-1",
    "title": "Design and Analysis of Experiments and Observational Studies using R – A textbook workbook",
    "section": "Chapter 1",
    "text": "Chapter 1\n\nlibrary(tidyverse)\nlibrary(patchwork)"
  },
  {
    "objectID": "examples-and-exercises.html#chapter-2",
    "href": "examples-and-exercises.html#chapter-2",
    "title": "Design and Analysis of Experiments and Observational Studies using R – A textbook workbook",
    "section": "CHAPTER 2",
    "text": "CHAPTER 2\n\nExample 2.1\n\nnhefshwdat1_filepath &lt;-\n  scidesignR::scidesignR_example(\"nhefshwdat1.csv\")\nnhefsdf &lt;- read.csv(nhefshwdat1_filepath)\nhead(nhefsdf[1:6], n = 3)\n\n  X seqn age sex race education.code\n1 1  233  42   0    1              1\n2 2  235  36   0    0              2\n3 3  244  56   1    1              2\n\ncolnames(nhefsdf)\n\n [1] \"X\"              \"seqn\"           \"age\"            \"sex\"           \n [5] \"race\"           \"education.code\" \"smokeintensity\" \"smokeyrs\"      \n [9] \"exercise\"       \"active\"         \"wt71\"           \"qsmk\"          \n[13] \"wt82_71\"        \"pqsmkobs\"       \"strat1\"         \"strat2\"        \n[17] \"strat3\"         \"strat4\"         \"strat5\"         \"stratvar\"      \n\n\n\n\nExample 2.2\n\nlevels(as.factor(nhefsdf$education.code))\n\n[1] \"1\" \"2\" \"3\" \"4\" \"5\"\n\nedcode &lt;- dplyr::recode(\n  as.factor(nhefsdf$education.code),\n  \"5\" = 1,\n  \"4\" = 1,\n  \"3\" = 0,\n  \"2\" = 0,\n  \"1\" = 0\n)\nlevels(as.factor(edcode))\n\n[1] \"0\" \"1\"\n\nnhefsdf %&gt;%\n  count(education.code) %&gt;% \n  mutate(pct = round(n/sum(n)*100,2))\n\n  education.code   n   pct\n1              1 291 18.58\n2              2 340 21.71\n3              3 637 40.68\n4              4 121  7.73\n5              5 177 11.30\n\nsummarise(\n  nhefsdf,\n  N = n(),\n  mean = mean(age),\n  median = median(age),\n  sd = sd(age)\n)\n\n     N     mean median       sd\n1 1566 43.65964     43 11.98981\n\nbarpl &lt;- nhefsdf %&gt;% \n  ggplot(aes(education.code)) +\n  geom_bar()\n\nhistpl &lt;- nhefsdf %&gt;% \n  ggplot(aes(age)) +\n  geom_histogram(binwidth = 10, colour = \"black\", fill = \"grey\")\n\nbarpl + histpl\n\n\n\n\n\n\n\n\n\n\nExample 2.3\n\nset.seed(11)\ngendf &lt;- data.frame(trt = sample(c(rep(\"trt1\", 5), rep(\"trt2\", 5))),\n                    value = sample(1:1000000, 10))\nhead(gendf, n = 3)\n\n   trt  value\n1 trt2 387134\n2 trt1 900071\n3 trt2 883541\n\n\n\n\nExample 2.4\n\nset.seed(11)\n\nexpand.grid(subj = 1:3, treat = c(\"A\", \"B\", \"C\")) %&gt;% \n  mutate(run_order = sample(1:9)) %&gt;% \n  arrange(run_order) %&gt;% \n  head(n = 3)\n\n  subj treat run_order\n1    3     A         1\n2    1     A         2\n3    2     C         3"
  },
  {
    "objectID": "LICENSE.html",
    "href": "LICENSE.html",
    "title": "MIT License",
    "section": "",
    "text": "MIT License\nCopyright (c) 2026 Irshaad Adatia\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\nTHE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE."
  }
]